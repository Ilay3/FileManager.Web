@page "/Files"
@{
    Response.Redirect("/");
}
@model FileManager.Web.Pages.Files.IndexModel
@{
    ViewData["Title"] = "Мои документы";
}

<div class="files-header">
    <h1>Мои документы</h1>
    <div class="user-info">
        Добро пожаловать, <strong>@User.Identity?.Name</strong>
        (@User.FindFirst(System.Security.Claims.ClaimTypes.Email)?.Value)
        <a href="/Account/Logout" class="btn btn-secondary">Выход</a>
    </div>
</div>

<div class="files-content">
    <div class="toolbar">
        <button class="btn btn-primary" onclick="alert('Функция загрузки будет добавлена в следующем этапе')">
            Загрузить файл
        </button>
        <button class="btn btn-secondary" onclick="alert('Функция создания папки будет добавлена в следующем этапе')">
            Создать папку
        </button>
        <input type="text" placeholder="Поиск файлов..." class="search-input" />
    </div>

    <div class="files-list">
        @if (Model.Files.Any())
        {
            <table class="files-table">
                <thead>
                    <tr>
                        <th>📄 Название</th>
                        <th>📊 Размер</th>
                        <th>📅 Изменен</th>
                        <th>⚙️ Действия</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var file in Model.Files)
                    {
                        <tr>
                            <td>
                                <strong>@file.Name</strong>
                                <small style="display: block; color: #666;">@file.Extension.ToUpper()</small>
                            </td>
                            <td>@FormatFileSize(file.SizeBytes)</td>
                            <td>@file.UpdatedAt?.ToString("dd.MM.yyyy HH:mm")</td>
                            <td>
                                <button class="btn btn-small" onclick="alert('Скачивание будет добавлено в следующем этапе')">
                                    Скачать
                                </button>
                                <button class="btn btn-small" onclick="alert('Удаление будет добавлено в следующем этапе')"
                                        data-confirm="Удалить файл @file.Name?">
                                    Удалить
                                </button>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        }
        else
        {
            <div class="empty-state">
                <div style="font-size: 48px; margin-bottom: 20px;">📁</div>
                <p>У вас пока нет файлов</p>
                <p style="color: #999; margin-bottom: 30px;">Загрузите первый файл, чтобы начать работу</p>
                <button class="btn btn-primary" onclick="alert('Функция загрузки будет добавлена в следующем этапе')">
                    Загрузить первый файл
                </button>
            </div>
        }
    </div>
</div>

@functions {
    private string FormatFileSize(long bytes)
    {
        if (bytes < 1024) return $"{bytes} Б";
        if (bytes < 1024 * 1024) return $"{bytes / 1024:F1} КБ";
        if (bytes < 1024 * 1024 * 1024) return $"{bytes / (1024 * 1024):F1} МБ";
        return $"{bytes / (1024 * 1024 * 1024):F1} ГБ";
    }
}
