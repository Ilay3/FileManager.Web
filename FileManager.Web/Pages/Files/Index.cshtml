@page "/Files"
@model FileManager.Web.Pages.Files.IndexModel
@attribute [Microsoft.AspNetCore.Authorization.Authorize]
@{
    ViewData["Title"] = "Мои документы";
}

<div class="files-content">
    <div class="toolbar">
        <button class="btn btn-primary" onclick="alert('Функция загрузки будет добавлена в следующем этапе')">
            📤 Загрузить файл
        </button>
        <button class="btn btn-secondary" onclick="alert('Функция создания папки будет добавлена в следующем этапе')">
            📁 Создать папку
        </button>
        <input type="text" placeholder="Поиск файлов..." class="search-input" />
    </div>

    <div class="files-list">
        @if (Model.Files.Any())
        {
            <table class="files-table">
                <thead>
                    <tr>
                        <th>📄 Название</th>
                        <th>📊 Размер</th>
                        <th>📅 Изменен</th>
                        <th>👤 Автор</th>
                        <th>⚙️ Действия</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var file in Model.Files)
                    {
                        <tr>
                            <td>
                                <strong>@file.Name</strong>
                                <small style="display: block; color: #666;">@file.Extension.ToUpper()</small>
                            </td>
                            <td>@FormatFileSize(file.SizeBytes)</td>
                            <td>@file.UpdatedAt?.ToString("dd.MM.yyyy HH:mm")</td>
                            <td>@file.UploadedBy.FullName</td>
                            <td>
                                <button class="btn btn-small" onclick="alert('Скачивание будет добавлено в следующем этапе')" title="Скачать">
                                    ⬇️
                                </button>
                                <button class="btn btn-small" onclick="alert('Просмотр будет добавлен в следующем этапе')" title="Просмотр">
                                    👁️
                                </button>
                                <button class="btn btn-small" onclick="confirmDelete('@file.Name', '@file.Id')" title="Удалить">
                                    🗑️
                                </button>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        }
        else
        {
            <div class="empty-state">
                <div style="font-size: 64px; margin-bottom: 20px;">📁</div>
                <h3>У вас пока нет файлов</h3>
                <p style="color: #999; margin-bottom: 30px;">Загрузите первый файл, чтобы начать работу с системой</p>
                <button class="btn btn-primary" onclick="alert('Функция загрузки будет добавлена в следующем этапе')">
                    📤 Загрузить первый файл
                </button>
            </div>
        }
    </div>
</div>

<script>
    function confirmDelete(fileName, fileId) {
        if (confirm('Вы уверены, что хотите удалить файл "' + fileName + '"?')) {
            alert('Функция удаления будет добавлена в следующем этапе');
            // TODO: Здесь будет запрос на удаление
        }
    }
</script>

@functions {
    private string FormatFileSize(long bytes)
    {
        if (bytes < 1024) return $"{bytes} Б";
        if (bytes < 1024 * 1024) return $"{bytes / 1024:F1} КБ";
        if (bytes < 1024 * 1024 * 1024) return $"{bytes / (1024 * 1024):F1} МБ";
        return $"{bytes / (1024 * 1024 * 1024):F1} ГБ";
    }
}