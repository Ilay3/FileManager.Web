@page "/Admin"
@model FileManager.Web.Pages.Admin.IndexModel
@attribute [Microsoft.AspNetCore.Authorization.Authorize]
@{
    ViewData["Title"] = "Администрирование";

    // Проверяем, что пользователь админ
    if (User.FindFirst("IsAdmin")?.Value != "True")
    {
        Response.Redirect("/Files");
        return;
    }
}

<div class="admin-header">
    <h1>Администрирование</h1>
    <p>Панель управления FileManager</p>
</div>

<div class="admin-stats">
    <div class="stat-card">
        <h3>👤 Пользователи</h3>
        <div class="stat-number">@Model.UsersCount</div>
        <p>Всего пользователей в системе</p>
    </div>

    <div class="stat-card">
        <h3>📄 Файлы</h3>
        <div class="stat-number">@Model.FilesCount</div>
        <p>Всего файлов загружено</p>
    </div>

    <div class="stat-card">
        <h3>📁 Папки</h3>
        <div class="stat-number">@Model.FoldersCount</div>
        <p>Всего создано папок</p>
    </div>

    <div class="stat-card">
        <h3>💾 Размер</h3>
        <div class="stat-number">@FormatFileSize(Model.TotalSize)</div>
        <p>Общий размер файлов</p>
    </div>
</div>

<div class="admin-actions">
    <h2>Быстрые действия</h2>
    <div class="action-buttons">
        <a class="btn btn-primary" href="/Admin/Users">
            Пользователи
        </a>
        <a class="btn btn-secondary" href="/Admin/Groups">
            Управление группами
        </a>
        <a class="btn btn-secondary" href="/Admin/Logs">
            Просмотреть логи
        </a>
        <button class="btn btn-secondary" onclick="alert('Настройки будут добавлены позже')">
            Настройки системы
        </button>
    </div>
</div>

@functions {
    private string FormatFileSize(long bytes)
    {
        if (bytes < 1024) return $"{bytes} Б";
        if (bytes < 1024 * 1024) return $"{bytes / 1024:F1} КБ";
        if (bytes < 1024 * 1024 * 1024) return $"{bytes / (1024 * 1024):F1} МБ";
        return $"{bytes / (1024 * 1024 * 1024):F1} ГБ";
    }
}
